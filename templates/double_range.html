{% block stylesheets %}
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

       
        .double-slider-box {
            background-color: #fff;
            padding: 20px 40px;
            border-radius: 10px;
            max-width: 20rem;
            width: 100%;
        }

        h3.range-title {
            margin-bottom: 4rem;
            text-align: center;
            color: #333;
        }

        .range-slider {
            position: relative;
            width: 100%;
            height: 5px;
            margin: 30px 0;
            background-color: #ddd; /* Lighter track for contrast */
            border-radius: 5px;
        }

        .slider-track {
            height: 100%;
            position: absolute;
            background-color: #fe696a;
            border-radius: 5px;
        }

        .range-slider input {
            position: absolute;
            width: 100%;
            background: none;
            pointer-events: none;
            top: 50%;
            transform: translateY(-50%);
            appearance: none;
            -webkit-appearance: none; /* For Chrome/Safari */
        }

        input[type="range"]::-webkit-slider-thumb {
            height: 25px;
            width: 25px;
            border-radius: 50%;
            border: 3px solid #fe696a; /* Thumb border color */
            background: #fff; /* Thumb background color */
            pointer-events: auto;
            -webkit-appearance: none;
            cursor: grab;
            box-shadow: 0 .125rem .5625rem -0.125rem rgba(0, 0, 0, .25);
            transition: background 0.3s ease;
        }

        input[type="range"]::-webkit-slider-thumb:active {
            cursor: grabbing;
        }

        input[type="range"]::-moz-range-thumb {
            height: 25px;
            width: 25px;
            border-radius: 50%;
            border: 3px solid #fe696a;
            background: #fff;
            pointer-events: auto;
            -moz-appearance: none;
            cursor: grab;
            box-shadow: 0 .125rem .5625rem -0.125rem rgba(0, 0, 0, .25);
            transition: background 0.3s ease;
        }

        input[type="range"]::-moz-range-thumb:active {
            cursor: grabbing;
        }


        .input-box {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .min-box,
        .max-box {
            width: 48%; /* Adjust width for spacing */
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .input-wrap {
            position: relative;
            width: 100%;
            margin-top: 10px;
        }

        .input-wrap input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: center;
            font-size: 1rem;
            color: #333;
            pointer-events: auto; /* Allow input for direct typing */
            -moz-appearance: textfield; /* Hide arrows for number input in Firefox */
        }

        .input-wrap input::-webkit-outer-spin-button,
        .input-wrap input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-wrap label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: #666;
            text-align: center;
        }

        .slider-tooltip {
            position: absolute;
            top: -30px; /* Position above the thumb */
            background-color: #fe696a;
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            transform: translateX(-50%); /* Center the tooltip */
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }

        input[type="range"]::-webkit-slider-thumb:hover + .slider-tooltip,
        input[type="range"]::-moz-range-thumb:hover + .slider-tooltip {
            opacity: 1;
        }

        /* Ensure tooltips are always visible for demonstration */
        .min-val + .slider-tooltip, .max-val + .slider-tooltip {
            opacity: 1;
        }
    </style>
    {%endblock%}

    <div class="double-slider-box">
        <h3 class="range-title">Price Range Slider</h3>
        <div class="range-slider">
            <div class="slider-track"></div>
            <input type="range" min="0" max="10000" value="0" id="min-val" class="min-val">
            <div class="slider-tooltip min-tooltip"></div>
            <input type="range" min="0" max="10000" value="10000" id="max-val" class="max-val">
            <div class="slider-tooltip max-tooltip"></div>
        </div>
        <div class="input-box">
            <div class="min-box">
                <label for="min-input">Min Price</label>
                <div class="input-wrap">
                    <input type="number" value="0" class="min-input" id="min-input">
                </div>
            </div>
            <div class="max-box">
                <label for="max-input">Max Price</label>
                <div class="input-wrap">
                    <input type="number" value="10000" class="max-input" id="max-input">
                </div>
            </div>
        </div>
    </div>
    {% block scripts%}
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const minVal = document.getElementById("min-val");
            const maxVal = document.getElementById("max-val");
            const priceInputMin = document.getElementById("min-input");
            const priceInputMax = document.getElementById("max-input");
            const minTooltip = document.querySelector(".min-tooltip");
            const maxTooltip = document.querySelector(".max-tooltip");
            const range = document.querySelector(".slider-track");

            const minGap = 500; // Minimum difference between min and max values
            const sliderMinValue = parseInt(minVal.min);
            const sliderMaxValue = parseInt(maxVal.max);

            // Function to update the slider and inputs
            function updateSliderAndInputs() {
                let minPrice = parseInt(minVal.value);
                let maxPrice = parseInt(maxVal.value);

                if (maxPrice - minPrice < minGap) {
                    if (event.target.classList.contains("min-val")) {
                        minVal.value = maxPrice - minGap;
                    } else {
                        maxVal.value = minPrice + minGap;
                    }
                }

                priceInputMin.value = minVal.value;
                priceInputMax.value = maxVal.value;

                minTooltip.textContent = `$${minVal.value}`;
                maxTooltip.textContent = `$${maxVal.value}`;

                // Update the track and tooltip positions
                const minPercentage = ((minVal.value - sliderMinValue) / (sliderMaxValue - sliderMinValue)) * 100;
                const maxPercentage = ((maxVal.value - sliderMinValue) / (sliderMaxValue - sliderMinValue)) * 100;

                range.style.left = `${minPercentage}%`;
                range.style.right = `${100 - maxPercentage}%`;

                // Adjust tooltip position for better visibility if close to edges
                minTooltip.style.left = `calc(${minPercentage}% + ${(25 * (1 - minPercentage / 100))}px)`;
                maxTooltip.style.left = `calc(${maxPercentage}% - ${(25 * (maxPercentage / 100))}px)`;

                // Old tooltip positioning:
                // minTooltip.style.left = minPercentage + "%";
                // maxTooltip.style.left = maxPercentage + "%";
            }

            // Initial update when the page loads
            updateSliderAndInputs();

            // Event listeners for slider changes
            minVal.addEventListener("input", updateSliderAndInputs);
            maxVal.addEventListener("input", updateSliderAndInputs);

            // Event listeners for direct input changes
            priceInputMin.addEventListener("change", function () {
                let minPrice = parseInt(priceInputMin.value);
                let maxPrice = parseInt(priceInputMax.value);

                if (minPrice < sliderMinValue) {
                    minPrice = sliderMinValue;
                }
                if (minPrice > maxPrice - minGap) {
                    minPrice = maxPrice - minGap;
                }
                minVal.value = minPrice;
                updateSliderAndInputs();
            });

            priceInputMax.addEventListener("change", function () {
                let minPrice = parseInt(priceInputMin.value);
                let maxPrice = parseInt(priceInputMax.value);

                if (maxPrice > sliderMaxValue) {
                    maxPrice = sliderMaxValue;
                }
                if (maxPrice < minPrice + minGap) {
                    maxPrice = minPrice + minGap;
                }
                maxVal.value = maxPrice;
                updateSliderAndInputs();
            });
        });
    </script>
    {%endblock%}
